<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>JP2 Test</title>
</head>
<body>
<h3>JP2 Test Page</h3>
<button id="show">Show poc.jp2</button>
<p id="info">Idle</p>
<img id="img" style="max-width:100%;display:none">

<script>
document.getElementById('show').onclick = async () => {
  const info = document.getElementById('info');
  const img = document.getElementById('img');
  info.textContent = 'Fetching poc.jp2...';
  try {
    const resp = await fetch('poc.jp2');
    if(!resp.ok) throw new Error('HTTP ' + resp.status);
    const buf = await resp.arrayBuffer();
    const u8 = new Uint8Array(buf);
    const sig = [0x00,0x00,0x00,0x0c,0x6a,0x50,0x20,0x20];
    const valid = u8.length >= 8 && sig.every((v,i)=>u8[i]===v);
    info.textContent = valid ? 'JP2 signature detected. Trying to render...' : 'No JP2 signature. Trying to render...';
    const blob = new Blob([u8], {type: 'image/jp2'});
    const url = URL.createObjectURL(blob);
    img.src = url;
    img.style.display = 'block';
    img.onload = () => info.textContent = 'Image displayed (browser supports JP2).';
    img.onerror = () => info.textContent = 'Failed to display (browser does not support JP2).';
  } catch(e) {
    info.textContent = 'Error: ' + e.message;
  }
};
</script>
</body>
</html>